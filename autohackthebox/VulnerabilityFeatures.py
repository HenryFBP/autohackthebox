import enum
from typing import Union

import lxml
from lxml import etree


class BoxVulnerabilityFeature(enum.Enum):
    """
    represents a specific "vulnerability feature" that a box has
    """
    SSH = "SSH"
    HTTP = "HTTP"
    HTTP_FORM = "HTTP_FORM"
    HTTP_API = "HTTP_API"
    SMB = "SMB"

    @staticmethod
    def from_string(name: str):
        prop = BoxVulnerabilityFeature.__getitem__(name.upper())
        if prop:
            return prop

        raise ValueError("Cannot find a BoxVulnerabilityFeature by name " + name)


def extractFeature(serviceXML: lxml.etree.Element) -> Union[None, BoxVulnerabilityFeature]:
    name = serviceXML.xpath('@name')
    if name:
        name: str = name[0]
        transf = BoxVulnerabilityFeature.from_string(name)
        return transf

    raise NotImplementedError("lol nyi")
